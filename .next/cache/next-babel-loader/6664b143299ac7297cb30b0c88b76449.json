{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { Label, Button } from 'semantic-ui-react';\nimport styled from 'styled-components';\nimport TaWaitingModal from './taWaitingModal';\nimport TAWebSocketController from './taWebSocket';\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\nimport { EventEmitter } from '../../util/EventEmitter';\nvar QueueDiv = styled.div.withConfig({\n  displayName: \"taQueueView__QueueDiv\",\n  componentId: \"bjnqi0-0\"\n})([\"grid-gap:2vh;\"]);\n_c = QueueDiv;\nvar QueueLabel = styled(Label).withConfig({\n  displayName: \"taQueueView__QueueLabel\",\n  componentId: \"bjnqi0-1\"\n})([\"text-align:center;\"]);\n_c2 = QueueLabel;\n\nvar TAQueueView = /*#__PURE__*/function (_Component) {\n  _inherits(TAQueueView, _Component);\n\n  var _super = _createSuper(TAQueueView);\n\n  function TAQueueView(props) {\n    var _this;\n\n    _classCallCheck(this, TAQueueView);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      displayStudentsStyle: {\n        display: 'grid'\n      },\n      iconToDisplay: 'caret square down outline',\n      queueWebSocketController: new TAWebSocketController(),\n      studentsInQueue: [],\n      me: _this.props.me,\n      nextStudentName: '',\n      currStudentBeingHelped: '',\n      isReadyToRender: false,\n      inCall: false\n    };\n\n    _this.defineEventEmitterCallbacks();\n\n    return _this;\n  }\n\n  _createClass(TAQueueView, [{\n    key: \"defineEventEmitterCallbacks\",\n    value: function defineEventEmitterCallbacks() {\n      var _this2 = this;\n\n      EventEmitter.subscribe('activateTAWaitingModal', function (nextStudentName) {\n        _this2.setState({\n          nextStudentName: nextStudentName\n        });\n\n        EventEmitter.publish('newTAWaitingModalProps', {\n          inviteNextStudent: true,\n          nextStudentName: nextStudentName\n        });\n      });\n      EventEmitter.subscribe('removeTAWaitingModalOnTimeout', function () {\n        var nextStudentName = _this2.state.nextStudentName;\n\n        _this2.createTimeoutNotification(nextStudentName);\n\n        _this2.setState({\n          currStudentBeingHelped: '',\n          nextStudentName: ''\n        });\n\n        EventEmitter.publish('newTAWaitingModalProps', {\n          inviteNextStudent: false,\n          nextStudentName: ''\n        });\n      });\n      EventEmitter.subscribe('removeTAWaitingModalOnAccept', function () {\n        _this2.setState({\n          nextStudentName: '',\n          inCall: true\n        });\n\n        EventEmitter.publish('newTAWaitingModalProps', {\n          inviteNextStudent: false,\n          nextStudentName: ''\n        });\n      });\n      EventEmitter.subscribe('removeTAWaitingModalOnDecline', function () {\n        var nextStudentName = _this2.state.nextStudentName;\n\n        _this2.createDeclineNotification(nextStudentName);\n\n        _this2.setState({\n          currStudentBeingHelped: '',\n          nextStudentName: ''\n        });\n\n        EventEmitter.publish('newTAWaitingModalProps', {\n          inviteNextStudent: false,\n          nextStudentName: ''\n        });\n      });\n      EventEmitter.subscribe('callOver', function () {\n        var queueWebSocketController = _this2.state.queueWebSocketController;\n        queueWebSocketController.signalCallOver();\n\n        _this2.setState({\n          inCall: false,\n          currStudentBeingHelped: ''\n        });\n      });\n      EventEmitter.subscribe('updateStudentsInQueue', function (msg) {\n        _this2.setState({\n          studentsInQueue: msg.map(function (_ref) {\n            var fullName = _ref.fullName;\n            return fullName;\n          })\n        });\n      });\n      EventEmitter.subscribe('updateCurrStudent', function (currStudentBeingHelped) {\n        _this2.setState({\n          currStudentBeingHelped: currStudentBeingHelped\n        });\n      });\n      EventEmitter.subscribe('initializeQueueOnGreeting', function (_ref2) {\n        var currStudent = _ref2.currStudent,\n            studentsInQueue = _ref2.studentsInQueue;\n        var myId = _this2.state.me.id;\n        var inQueue = studentsInQueue.filter(function (_ref3) {\n          var id = _ref3.id;\n          return id === myId;\n        }).length > 0;\n\n        _this2.setState({\n          currStudentBeingHelped: currStudent,\n          studentsInQueue: studentsInQueue.map(function (_ref4) {\n            var fullName = _ref4.fullName;\n            return fullName;\n          }),\n          inQueue: inQueue\n        });\n      });\n    }\n  }, {\n    key: \"createTimeoutNotification\",\n    value: function createTimeoutNotification(studentName) {\n      NotificationManager.info(\"\".concat(studentName, \"'s Invitation Has Expired\"));\n    }\n  }, {\n    key: \"createDeclineNotification\",\n    value: function createDeclineNotification(studentName) {\n      NotificationManager.info(\"\".concat(studentName, \" Has Declined The Call\"));\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var courseId = Number(window.location.href.split('/')[4]);\n      var onJoin = this.props.onJoin;\n      var _this$state = this.state,\n          queueWebSocketController = _this$state.queueWebSocketController,\n          me = _this$state.me;\n      queueWebSocketController.start({\n        me: me,\n        courseId: courseId,\n        onJoin: onJoin\n      });\n      this.setState({\n        isReadyToRender: true\n      });\n    }\n  }, {\n    key: \"isStudentDisplayed\",\n    value: function isStudentDisplayed() {\n      var display = this.state.displayStudentsStyle.display;\n      return display === 'grid';\n    }\n  }, {\n    key: \"alterStudentDisplay\",\n    value: function alterStudentDisplay() {\n      var displayStudentsStyle = this.isStudentDisplayed() ? {\n        display: 'none'\n      } : {\n        display: 'grid'\n      };\n      var iconToDisplay = this.isStudentDisplayed() ? 'caret square up outline' : 'caret square down outline';\n      this.setState({\n        displayStudentsStyle: displayStudentsStyle,\n        iconToDisplay: iconToDisplay\n      });\n    }\n  }, {\n    key: \"getNextStudentInQueue\",\n    value: function getNextStudentInQueue() {\n      this.state.queueWebSocketController.getNextStudent();\n    }\n  }, {\n    key: \"getButtonToDisplay\",\n    value: function getButtonToDisplay() {\n      if (this.state.inCall) {\n        return null;\n      }\n\n      return __jsx(\"div\", {\n        style: {\n          position: 'absolute',\n          width: 'calc(100% - 38px)',\n          bottom: 14,\n          display: 'inline-flex'\n        }\n      }, __jsx(Button, {\n        style: {\n          width: '100%',\n          fontSize: '1vw'\n        },\n        onClick: this.getNextStudentInQueue.bind(this),\n        primary: true\n      }, \"Next\"));\n    }\n  }, {\n    key: \"createCurrStudentLabel\",\n    value: function createCurrStudentLabel() {\n      var currStudentBeingHelped = this.state.currStudentBeingHelped;\n\n      if (currStudentBeingHelped.length == 0) {\n        return null;\n      }\n\n      return __jsx(QueueLabel, {\n        style: {\n          fontSize: '1.2vw',\n          textAlign: 'center',\n          width: '95%',\n          marginBottom: '2%',\n          minWidth: '41px',\n          marginLeft: '.8%',\n          backgroundColor: 'red',\n          marginRight: '1%'\n        },\n        key: currStudentBeingHelped\n      }, currStudentBeingHelped);\n    }\n  }, {\n    key: \"createQueueLabel\",\n    value: function createQueueLabel(student) {\n      return __jsx(QueueLabel, {\n        style: {\n          fontSize: '1.2vw',\n          textAlign: 'center',\n          width: '95%',\n          marginBottom: '2%',\n          minWidth: '41px',\n          marginLeft: '.8%',\n          marginRight: '1%'\n        },\n        key: student\n      }, student);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var isReadyToRender = this.state.isReadyToRender;\n\n      if (!isReadyToRender) {\n        return null;\n      }\n\n      var queueLabels = this.state.displayStudentsStyle.display == 'none' ? __jsx(React.Fragment, null) : this.state.studentsInQueue.map(this.createQueueLabel);\n      return __jsx(QueueDiv, null, __jsx(TaWaitingModal, null), __jsx(Button.Group, {\n        size: \"huge\",\n        style: {\n          marginBottom: 12,\n          width: '95%'\n        },\n        fluid: true,\n        vertical: true\n      }, __jsx(Button, {\n        compact: true,\n        content: \"Queue\",\n        icon: this.state.iconToDisplay,\n        labelPosition: \"right\",\n        onClick: this.alterStudentDisplay.bind(this),\n        style: {\n          fontSize: '1.5vw',\n          textAlign: 'center',\n          width: '100%',\n          marginBottom: '2%',\n          minWidth: '41px'\n        }\n      })), this.createCurrStudentLabel(), __jsx(QueueDiv, {\n        style: {\n          width: '100%',\n          marginBottom: '2%',\n          minWidth: '41px'\n        }\n      }, queueLabels), this.getButtonToDisplay(), __jsx(NotificationContainer, null));\n    }\n  }]);\n\n  return TAQueueView;\n}(Component);\n\nexport { TAQueueView as default };\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"QueueDiv\");\n$RefreshReg$(_c2, \"QueueLabel\");","map":{"version":3,"sources":["C:/Users/ryanj/Documents/mercury/components/queue/ta/taQueueView.js"],"names":["React","Component","Label","Button","styled","TaWaitingModal","TAWebSocketController","NotificationContainer","NotificationManager","EventEmitter","QueueDiv","div","QueueLabel","TAQueueView","props","state","displayStudentsStyle","display","iconToDisplay","queueWebSocketController","studentsInQueue","me","nextStudentName","currStudentBeingHelped","isReadyToRender","inCall","defineEventEmitterCallbacks","subscribe","setState","publish","inviteNextStudent","createTimeoutNotification","createDeclineNotification","signalCallOver","msg","map","fullName","currStudent","myId","id","inQueue","filter","length","studentName","info","courseId","Number","window","location","href","split","onJoin","start","isStudentDisplayed","getNextStudent","position","width","bottom","fontSize","getNextStudentInQueue","bind","textAlign","marginBottom","minWidth","marginLeft","backgroundColor","marginRight","student","queueLabels","createQueueLabel","alterStudentDisplay","createCurrStudentLabel","getButtonToDisplay"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { Label, Button } from 'semantic-ui-react'\r\nimport styled from 'styled-components'\r\nimport TaWaitingModal from './taWaitingModal'\r\nimport TAWebSocketController from './taWebSocket'\r\nimport { NotificationContainer, NotificationManager } from 'react-notifications'\r\nimport { EventEmitter } from '../../util/EventEmitter'\r\n\r\nconst QueueDiv = styled.div`\r\n  grid-gap: 2vh;\r\n`\r\n\r\nconst QueueLabel = styled(Label)`\r\n  text-align: center;\r\n`\r\n\r\nexport default class TAQueueView extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      displayStudentsStyle: { display: 'grid' },\r\n      iconToDisplay: 'caret square down outline',\r\n      queueWebSocketController: new TAWebSocketController(),\r\n      studentsInQueue: [],\r\n      me: this.props.me,\r\n      nextStudentName: '',\r\n      currStudentBeingHelped: '',\r\n      isReadyToRender: false,\r\n      inCall: false,\r\n    }\r\n\r\n    this.defineEventEmitterCallbacks()\r\n  }\r\n\r\n  defineEventEmitterCallbacks() {\r\n    EventEmitter.subscribe('activateTAWaitingModal', (nextStudentName) => {\r\n      this.setState({ nextStudentName })\r\n\r\n      EventEmitter.publish('newTAWaitingModalProps', {\r\n        inviteNextStudent: true,\r\n        nextStudentName,\r\n      })\r\n    })\r\n\r\n    EventEmitter.subscribe('removeTAWaitingModalOnTimeout', () => {\r\n      const { nextStudentName } = this.state\r\n      this.createTimeoutNotification(nextStudentName)\r\n      this.setState({ currStudentBeingHelped: '', nextStudentName: '' })\r\n\r\n      EventEmitter.publish('newTAWaitingModalProps', {\r\n        inviteNextStudent: false,\r\n        nextStudentName: '',\r\n      })\r\n    })\r\n\r\n    EventEmitter.subscribe('removeTAWaitingModalOnAccept', () => {\r\n      this.setState({ nextStudentName: '', inCall: true })\r\n\r\n      EventEmitter.publish('newTAWaitingModalProps', {\r\n        inviteNextStudent: false,\r\n        nextStudentName: '',\r\n      })\r\n    })\r\n\r\n    EventEmitter.subscribe('removeTAWaitingModalOnDecline', () => {\r\n      const { nextStudentName } = this.state\r\n      this.createDeclineNotification(nextStudentName)\r\n      this.setState({ currStudentBeingHelped: '', nextStudentName: '' })\r\n\r\n      EventEmitter.publish('newTAWaitingModalProps', {\r\n        inviteNextStudent: false,\r\n        nextStudentName: '',\r\n      })\r\n    })\r\n\r\n    EventEmitter.subscribe('callOver', () => {\r\n      const { queueWebSocketController } = this.state\r\n      queueWebSocketController.signalCallOver()\r\n      this.setState({ inCall: false, currStudentBeingHelped: '' })\r\n    })\r\n\r\n    EventEmitter.subscribe('updateStudentsInQueue', (msg) => {\r\n      this.setState({ studentsInQueue: msg.map(({ fullName }) => fullName) })\r\n    })\r\n\r\n    EventEmitter.subscribe('updateCurrStudent', (currStudentBeingHelped) => {\r\n      this.setState({ currStudentBeingHelped })\r\n    })\r\n\r\n    EventEmitter.subscribe(\r\n      'initializeQueueOnGreeting',\r\n      ({ currStudent, studentsInQueue }) => {\r\n        const myId = this.state.me.id\r\n        const inQueue =\r\n          studentsInQueue.filter(({ id }) => id === myId).length > 0\r\n        this.setState({\r\n          currStudentBeingHelped: currStudent,\r\n          studentsInQueue: studentsInQueue.map(({ fullName }) => fullName),\r\n          inQueue,\r\n        })\r\n      }\r\n    )\r\n  }\r\n\r\n  createTimeoutNotification(studentName) {\r\n    NotificationManager.info(`${studentName}'s Invitation Has Expired`)\r\n  }\r\n\r\n  createDeclineNotification(studentName) {\r\n    NotificationManager.info(`${studentName} Has Declined The Call`)\r\n  }\r\n\r\n  componentDidMount() {\r\n    const courseId = Number(window.location.href.split('/')[4])\r\n    const onJoin = this.props.onJoin\r\n    const { queueWebSocketController, me } = this.state\r\n    queueWebSocketController.start({ me, courseId, onJoin })\r\n    this.setState({ isReadyToRender: true })\r\n  }\r\n\r\n  isStudentDisplayed() {\r\n    let { display } = this.state.displayStudentsStyle\r\n    return display === 'grid'\r\n  }\r\n\r\n  alterStudentDisplay() {\r\n    let displayStudentsStyle = this.isStudentDisplayed()\r\n      ? { display: 'none' }\r\n      : { display: 'grid' }\r\n\r\n    let iconToDisplay = this.isStudentDisplayed()\r\n      ? 'caret square up outline'\r\n      : 'caret square down outline'\r\n\r\n    this.setState({ displayStudentsStyle, iconToDisplay })\r\n  }\r\n\r\n  getNextStudentInQueue() {\r\n    this.state.queueWebSocketController.getNextStudent()\r\n  }\r\n\r\n  getButtonToDisplay() {\r\n    if (this.state.inCall) {\r\n      return null\r\n    }\r\n\r\n    return (\r\n      <div\r\n        style={{\r\n          position: 'absolute',\r\n          width: 'calc(100% - 38px)',\r\n          bottom: 14,\r\n          display: 'inline-flex',\r\n        }}\r\n      >\r\n        <Button\r\n          style={{ width: '100%', fontSize: '1vw' }}\r\n          onClick={this.getNextStudentInQueue.bind(this)}\r\n          primary\r\n        >\r\n          Next\r\n        </Button>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  createCurrStudentLabel() {\r\n    const { currStudentBeingHelped } = this.state\r\n\r\n    if (currStudentBeingHelped.length == 0) {\r\n      return null\r\n    }\r\n\r\n    return (\r\n      <QueueLabel\r\n        style={{\r\n          fontSize: '1.2vw',\r\n          textAlign: 'center',\r\n          width: '95%',\r\n          marginBottom: '2%',\r\n          minWidth: '41px',\r\n          marginLeft: '.8%',\r\n          backgroundColor: 'red',\r\n          marginRight: '1%',\r\n        }}\r\n        key={currStudentBeingHelped}\r\n      >\r\n        {currStudentBeingHelped}\r\n      </QueueLabel>\r\n    )\r\n  }\r\n\r\n  createQueueLabel(student) {\r\n    return (\r\n      <QueueLabel\r\n        style={{\r\n          fontSize: '1.2vw',\r\n          textAlign: 'center',\r\n          width: '95%',\r\n          marginBottom: '2%',\r\n          minWidth: '41px',\r\n          marginLeft: '.8%',\r\n          marginRight: '1%',\r\n        }}\r\n        key={student}\r\n      >\r\n        {student}\r\n      </QueueLabel>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { isReadyToRender } = this.state\r\n\r\n    if (!isReadyToRender) {\r\n      return null\r\n    }\r\n\r\n    const queueLabels =\r\n      this.state.displayStudentsStyle.display == 'none' ? (\r\n        <></>\r\n      ) : (\r\n        this.state.studentsInQueue.map(this.createQueueLabel)\r\n      )\r\n\r\n    return (\r\n      <QueueDiv>\r\n        <TaWaitingModal />\r\n\r\n        <Button.Group\r\n          size=\"huge\"\r\n          style={{ marginBottom: 12, width: '95%' }}\r\n          fluid\r\n          vertical\r\n        >\r\n          <Button\r\n            compact\r\n            content=\"Queue\"\r\n            icon={this.state.iconToDisplay}\r\n            labelPosition=\"right\"\r\n            onClick={this.alterStudentDisplay.bind(this)}\r\n            style={{\r\n              fontSize: '1.5vw',\r\n              textAlign: 'center',\r\n              width: '100%',\r\n              marginBottom: '2%',\r\n              minWidth: '41px',\r\n            }}\r\n          />\r\n        </Button.Group>\r\n\r\n        {this.createCurrStudentLabel()}\r\n\r\n        <QueueDiv\r\n          style={{ width: '100%', marginBottom: '2%', minWidth: '41px' }}\r\n        >\r\n          {queueLabels}\r\n        </QueueDiv>\r\n\r\n        {this.getButtonToDisplay()}\r\n\r\n        <NotificationContainer />\r\n      </QueueDiv>\r\n    )\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}