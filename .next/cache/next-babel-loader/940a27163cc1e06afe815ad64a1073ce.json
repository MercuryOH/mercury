{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\nimport YourTurnModal from './yourTurnModal';\nimport StudentWebSocketController from './studentWebSocket';\nimport { Label, Button } from 'semantic-ui-react';\nimport { NotificationContainer, NotificationManager } from 'react-notifications';\nimport { EventEmitter } from '../../util/EventEmitter';\nvar QueueDiv = styled.div.withConfig({\n  displayName: \"studentQueueView__QueueDiv\",\n  componentId: \"sc-1qcvoz5-0\"\n})([\"grid-gap:2vh;\"]);\n_c = QueueDiv;\nvar QueueLabel = styled(Label).withConfig({\n  displayName: \"studentQueueView__QueueLabel\",\n  componentId: \"sc-1qcvoz5-1\"\n})([\"text-align:center;\"]);\n/**\r\n * This is how the student views the Queue\r\n */\n\n_c2 = QueueLabel;\n\nvar StudentQueueView = /*#__PURE__*/function (_Component) {\n  _inherits(StudentQueueView, _Component);\n\n  var _super = _createSuper(StudentQueueView);\n\n  function StudentQueueView(props) {\n    var _this;\n\n    _classCallCheck(this, StudentQueueView);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      displayStudentsStyle: {\n        display: 'grid'\n      },\n      iconToDisplay: 'caret square down outline',\n      queueWebSocketController: new StudentWebSocketController(),\n      studentsInQueue: [],\n      me: _this.props.me,\n      inQueue: false,\n      isYourTurn: false,\n      nextStudentName: '',\n      isReadyToRender: false,\n      office: _this.props.office,\n      inCall: false,\n      currentGroup: {\n        id: '',\n        name: ''\n      },\n      onJoin: _this.props.onJoin\n    };\n\n    _this.defineEventEmitterCallbacks();\n\n    return _this;\n  }\n  /**\r\n   * Define EventEmitter subscribers\r\n   */\n\n\n  _createClass(StudentQueueView, [{\n    key: \"defineEventEmitterCallbacks\",\n    value: function defineEventEmitterCallbacks() {\n      var _this2 = this;\n\n      EventEmitter.subscribe('activateYourTurnModal', function (TAName) {\n        _this2.setState({\n          inQueue: false\n        });\n\n        EventEmitter.publish('startYourTurnModalTimer', TAName);\n      });\n      EventEmitter.subscribe('updateStudentsInQueue', function (msg) {\n        _this2.setState({\n          studentsInQueue: msg\n        });\n      });\n      EventEmitter.subscribe('addMeToQueue', function () {\n        _this2.setState({\n          inQueue: true\n        });\n      });\n      EventEmitter.subscribe('removeMeFromQueue', function () {\n        _this2.setState({\n          inQueue: false\n        });\n      });\n      EventEmitter.subscribe('studentTimeout', function (TAName) {\n        var queueWebSocketController = _this2.state.queueWebSocketController;\n        queueWebSocketController.signalStudentTimeout(TAName);\n\n        _this2.createTimeoutNotification();\n      });\n      EventEmitter.subscribe('studentJoinTA', function (TAName) {\n        var _this2$state = _this2.state,\n            queueWebSocketController = _this2$state.queueWebSocketController,\n            office = _this2$state.office,\n            onJoin = _this2$state.onJoin;\n        queueWebSocketController.signalJoinTA(office, TAName);\n\n        _this2.setState({\n          inQueue: false,\n          inCall: true\n        });\n\n        onJoin(office);\n      });\n      EventEmitter.subscribe('studentInviteTA', function (TAName) {\n        var _this2$state2 = _this2.state,\n            queueWebSocketController = _this2$state2.queueWebSocketController,\n            onJoin = _this2$state2.onJoin,\n            currentGroup = _this2$state2.currentGroup;\n        queueWebSocketController.signalJoinTA(currentGroup, TAName);\n\n        _this2.setState({\n          inQueue: false,\n          inCall: true\n        });\n\n        onJoin(currentGroup);\n      });\n      EventEmitter.subscribe('studentDeclineTA', function (TAName) {\n        var _this2$state3 = _this2.state,\n            queueWebSocketController = _this2$state3.queueWebSocketController,\n            onJoin = _this2$state3.onJoin,\n            currentGroup = _this2$state3.currentGroup;\n        queueWebSocketController.signalDeclineTA(TAName);\n\n        _this2.setState({\n          inQueue: false\n        });\n\n        onJoin(currentGroup);\n      });\n      EventEmitter.subscribe('currentGroupChange', function (currentGroup) {\n        console.log(currentGroup);\n\n        _this2.setState({\n          currentGroup: currentGroup\n        });\n      });\n      EventEmitter.subscribe('callOver', function () {\n        _this2.setState({\n          inCall: false\n        });\n      });\n    }\n  }, {\n    key: \"createTimeoutNotification\",\n    value: function createTimeoutNotification() {\n      NotificationManager.info('Your Invitation Has Expired');\n    }\n  }, {\n    key: \"isStudentDisplayed\",\n    value: function isStudentDisplayed() {\n      var display = this.state.displayStudentsStyle.display;\n      return display === 'grid';\n    }\n  }, {\n    key: \"alterStudentDisplay\",\n    value: function alterStudentDisplay() {\n      var displayStudentsStyle = this.isStudentDisplayed() ? {\n        display: 'none'\n      } : {\n        display: 'grid'\n      };\n      var iconToDisplay = this.isStudentDisplayed() ? 'caret square up outline' : 'caret square down outline';\n      this.setState({\n        displayStudentsStyle: displayStudentsStyle,\n        iconToDisplay: iconToDisplay\n      });\n    }\n  }, {\n    key: \"addMeToQueue\",\n    value: function addMeToQueue() {\n      var _this$state$me = this.state.me,\n          firstName = _this$state$me.firstName,\n          lastName = _this$state$me.lastName;\n      var fullName = \"\".concat(firstName, \" \").concat(lastName);\n\n      if (this.state.studentsInQueue.indexOf(fullName) >= 0) {\n        return;\n      }\n\n      this.state.queueWebSocketController.addMeToQueue();\n    }\n  }, {\n    key: \"removeMeFromQueue\",\n    value: function removeMeFromQueue() {\n      var _this$state$me2 = this.state.me,\n          firstName = _this$state$me2.firstName,\n          lastName = _this$state$me2.lastName;\n      var fullName = \"\".concat(firstName, \" \").concat(lastName);\n\n      if (this.state.studentsInQueue.indexOf(fullName) < 0) {\n        return;\n      }\n\n      this.state.queueWebSocketController.removeMeFromQueue();\n    }\n  }, {\n    key: \"getButtonToDisplay\",\n    value: function getButtonToDisplay() {\n      if (this.state.inCall) {\n        return null;\n      }\n\n      var buttonToDisplay = this.state.inQueue ? __jsx(Button, {\n        onClick: this.removeMeFromQueue.bind(this),\n        style: {\n          width: '100%',\n          fontSize: '1vw'\n        },\n        secondary: true\n      }, \"Leave Queue\") : __jsx(Button, {\n        onClick: this.addMeToQueue.bind(this),\n        style: {\n          width: '100%',\n          fontSize: '1vw'\n        },\n        primary: true\n      }, \"Join Queue\");\n      return __jsx(\"div\", {\n        style: {\n          position: 'absolute',\n          width: 'calc(100% - 38px)',\n          bottom: 14,\n          display: 'inline-flex'\n        }\n      }, buttonToDisplay);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$state = this.state,\n          me = _this$state.me,\n          queueWebSocketController = _this$state.queueWebSocketController;\n      var courseId = Number(window.location.href.split('/')[4]);\n      queueWebSocketController.start({\n        me: me,\n        courseId: courseId\n      });\n      this.setState({\n        isReadyToRender: true\n      });\n    }\n  }, {\n    key: \"createCurrStudentLabel\",\n    value: function createCurrStudentLabel(student) {\n      return __jsx(QueueLabel, {\n        style: {\n          fontSize: '1.2vw',\n          textAlign: 'center',\n          width: '95%',\n          marginBottom: '2%',\n          minWidth: '41px',\n          marginLeft: '.8%',\n          backgroundColor: 'red',\n          marginRight: '1%'\n        },\n        key: student\n      }, student);\n    }\n  }, {\n    key: \"createQueueLabel\",\n    value: function createQueueLabel(student) {\n      return __jsx(QueueLabel, {\n        style: {\n          fontSize: '1.2vw',\n          textAlign: 'center',\n          width: '95%',\n          marginBottom: '2%',\n          minWidth: '41px',\n          marginLeft: '.8%',\n          marginRight: '1%'\n        },\n        key: student\n      }, student);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var isReadyToRender = this.state.isReadyToRender;\n\n      if (!isReadyToRender) {\n        return null;\n      }\n\n      var queueLabels = this.isStudentDisplayed() ? this.state.studentsInQueue.map(this.createQueueLabel) : [];\n      return __jsx(QueueDiv, null, __jsx(YourTurnModal, null), __jsx(Button.Group, {\n        size: \"huge\",\n        style: {\n          marginBottom: 12,\n          width: '95%'\n        },\n        fluid: true,\n        vertical: true\n      }, __jsx(Button, {\n        compact: true,\n        content: \"Queue\",\n        icon: this.state.iconToDisplay,\n        labelPosition: \"right\",\n        onClick: this.alterStudentDisplay.bind(this),\n        style: {\n          fontSize: '1.5vw',\n          textAlign: 'center',\n          width: '100%',\n          marginBottom: '2%',\n          minWidth: '41px'\n        }\n      })), __jsx(QueueDiv, {\n        style: {\n          width: '100%',\n          marginBottom: '2%',\n          minWidth: '41px'\n        }\n      }, queueLabels), this.getButtonToDisplay(), __jsx(NotificationContainer, null));\n    }\n  }]);\n\n  return StudentQueueView;\n}(Component);\n\nStudentQueueView.propTypes = {\n  onJoin: PropTypes.func.isRequired\n};\nexport default StudentQueueView;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"QueueDiv\");\n$RefreshReg$(_c2, \"QueueLabel\");","map":{"version":3,"sources":["C:/Users/ryanj/Documents/mercury/components/queue/student/studentQueueView.js"],"names":["React","Component","PropTypes","styled","YourTurnModal","StudentWebSocketController","Label","Button","NotificationContainer","NotificationManager","EventEmitter","QueueDiv","div","QueueLabel","StudentQueueView","props","state","displayStudentsStyle","display","iconToDisplay","queueWebSocketController","studentsInQueue","me","inQueue","isYourTurn","nextStudentName","isReadyToRender","office","inCall","currentGroup","id","name","onJoin","defineEventEmitterCallbacks","subscribe","TAName","setState","publish","msg","signalStudentTimeout","createTimeoutNotification","signalJoinTA","signalDeclineTA","console","log","info","isStudentDisplayed","firstName","lastName","fullName","indexOf","addMeToQueue","removeMeFromQueue","buttonToDisplay","bind","width","fontSize","position","bottom","courseId","Number","window","location","href","split","start","student","textAlign","marginBottom","minWidth","marginLeft","backgroundColor","marginRight","queueLabels","map","createQueueLabel","alterStudentDisplay","getButtonToDisplay","propTypes","func","isRequired"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport styled from 'styled-components'\r\nimport YourTurnModal from './yourTurnModal'\r\nimport StudentWebSocketController from './studentWebSocket'\r\nimport { Label, Button } from 'semantic-ui-react'\r\nimport { NotificationContainer, NotificationManager } from 'react-notifications'\r\nimport { EventEmitter } from '../../util/EventEmitter'\r\n\r\nconst QueueDiv = styled.div`\r\n  grid-gap: 2vh;\r\n`\r\n\r\nconst QueueLabel = styled(Label)`\r\n  text-align: center;\r\n`\r\n\r\n/**\r\n * This is how the student views the Queue\r\n */\r\n\r\nclass StudentQueueView extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      displayStudentsStyle: { display: 'grid' },\r\n      iconToDisplay: 'caret square down outline',\r\n      queueWebSocketController: new StudentWebSocketController(),\r\n      studentsInQueue: [],\r\n      me: this.props.me,\r\n      inQueue: false,\r\n      isYourTurn: false,\r\n      nextStudentName: '',\r\n      isReadyToRender: false,\r\n      office: this.props.office,\r\n      inCall: false,\r\n      currentGroup: { id: '', name: '' },\r\n      onJoin: this.props.onJoin,\r\n    }\r\n\r\n    this.defineEventEmitterCallbacks()\r\n  }\r\n\r\n  /**\r\n   * Define EventEmitter subscribers\r\n   */\r\n\r\n  defineEventEmitterCallbacks() {\r\n    EventEmitter.subscribe('activateYourTurnModal', (TAName) => {\r\n      this.setState({ inQueue: false })\r\n      EventEmitter.publish('startYourTurnModalTimer', TAName)\r\n    })\r\n\r\n    EventEmitter.subscribe('updateStudentsInQueue', (msg) => {\r\n      this.setState({ studentsInQueue: msg })\r\n    })\r\n\r\n    EventEmitter.subscribe('addMeToQueue', () => {\r\n      this.setState({ inQueue: true })\r\n    })\r\n\r\n    EventEmitter.subscribe('removeMeFromQueue', () => {\r\n      this.setState({ inQueue: false })\r\n    })\r\n\r\n    EventEmitter.subscribe('studentTimeout', (TAName) => {\r\n      const { queueWebSocketController } = this.state\r\n      queueWebSocketController.signalStudentTimeout(TAName)\r\n      this.createTimeoutNotification()\r\n    })\r\n\r\n    EventEmitter.subscribe('studentJoinTA', (TAName) => {\r\n      const { queueWebSocketController, office, onJoin } = this.state\r\n      queueWebSocketController.signalJoinTA(office, TAName)\r\n      this.setState({ inQueue: false, inCall: true })\r\n      onJoin(office)\r\n    })\r\n\r\n    EventEmitter.subscribe('studentInviteTA', (TAName) => {\r\n      const { queueWebSocketController, onJoin, currentGroup } = this.state\r\n      queueWebSocketController.signalJoinTA(currentGroup, TAName)\r\n      this.setState({ inQueue: false, inCall: true })\r\n      onJoin(currentGroup)\r\n    })\r\n\r\n    EventEmitter.subscribe('studentDeclineTA', (TAName) => {\r\n      const { queueWebSocketController, onJoin, currentGroup } = this.state\r\n      queueWebSocketController.signalDeclineTA(TAName)\r\n      this.setState({ inQueue: false })\r\n      onJoin(currentGroup)\r\n    })\r\n\r\n    EventEmitter.subscribe('currentGroupChange', (currentGroup) => {\r\n      console.log(currentGroup)\r\n      this.setState({ currentGroup })\r\n    })\r\n\r\n    EventEmitter.subscribe('callOver', () => {\r\n      this.setState({ inCall: false })\r\n    })\r\n  }\r\n\r\n  createTimeoutNotification() {\r\n    NotificationManager.info('Your Invitation Has Expired')\r\n  }\r\n\r\n  isStudentDisplayed() {\r\n    let { display } = this.state.displayStudentsStyle\r\n    return display === 'grid'\r\n  }\r\n\r\n  alterStudentDisplay() {\r\n    let displayStudentsStyle = this.isStudentDisplayed()\r\n      ? { display: 'none' }\r\n      : { display: 'grid' }\r\n\r\n    let iconToDisplay = this.isStudentDisplayed()\r\n      ? 'caret square up outline'\r\n      : 'caret square down outline'\r\n\r\n    this.setState({ displayStudentsStyle, iconToDisplay })\r\n  }\r\n\r\n  addMeToQueue() {\r\n    const { firstName, lastName } = this.state.me\r\n    const fullName = `${firstName} ${lastName}`\r\n\r\n    if (this.state.studentsInQueue.indexOf(fullName) >= 0) {\r\n      return\r\n    }\r\n\r\n    this.state.queueWebSocketController.addMeToQueue()\r\n  }\r\n\r\n  removeMeFromQueue() {\r\n    const { firstName, lastName } = this.state.me\r\n    const fullName = `${firstName} ${lastName}`\r\n\r\n    if (this.state.studentsInQueue.indexOf(fullName) < 0) {\r\n      return\r\n    }\r\n\r\n    this.state.queueWebSocketController.removeMeFromQueue()\r\n  }\r\n\r\n  getButtonToDisplay() {\r\n    if (this.state.inCall) {\r\n      return null\r\n    }\r\n\r\n    const buttonToDisplay = this.state.inQueue ? (\r\n      <Button\r\n        onClick={this.removeMeFromQueue.bind(this)}\r\n        style={{ width: '100%', fontSize: '1vw' }}\r\n        secondary\r\n      >\r\n        Leave Queue\r\n      </Button>\r\n    ) : (\r\n      <Button\r\n        onClick={this.addMeToQueue.bind(this)}\r\n        style={{ width: '100%', fontSize: '1vw' }}\r\n        primary\r\n      >\r\n        Join Queue\r\n      </Button>\r\n    )\r\n\r\n    return (\r\n      <div\r\n        style={{\r\n          position: 'absolute',\r\n          width: 'calc(100% - 38px)',\r\n          bottom: 14,\r\n          display: 'inline-flex',\r\n        }}\r\n      >\r\n        {buttonToDisplay}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { me, queueWebSocketController } = this.state\r\n    const courseId = Number(window.location.href.split('/')[4])\r\n    queueWebSocketController.start({ me, courseId })\r\n    this.setState({ isReadyToRender: true })\r\n  }\r\n\r\n  createCurrStudentLabel(student) {\r\n    return (\r\n      <QueueLabel\r\n        style={{\r\n          fontSize: '1.2vw',\r\n          textAlign: 'center',\r\n          width: '95%',\r\n          marginBottom: '2%',\r\n          minWidth: '41px',\r\n          marginLeft: '.8%',\r\n          backgroundColor: 'red',\r\n          marginRight: '1%',\r\n        }}\r\n        key={student}\r\n      >\r\n        {student}\r\n      </QueueLabel>\r\n    )\r\n  }\r\n\r\n  createQueueLabel(student) {\r\n    return (\r\n      <QueueLabel\r\n        style={{\r\n          fontSize: '1.2vw',\r\n          textAlign: 'center',\r\n          width: '95%',\r\n          marginBottom: '2%',\r\n          minWidth: '41px',\r\n          marginLeft: '.8%',\r\n          marginRight: '1%',\r\n        }}\r\n        key={student}\r\n      >\r\n        {student}\r\n      </QueueLabel>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { isReadyToRender } = this.state\r\n\r\n    if (!isReadyToRender) {\r\n      return null\r\n    }\r\n\r\n    const queueLabels = this.isStudentDisplayed()\r\n      ? this.state.studentsInQueue.map(this.createQueueLabel)\r\n      : []\r\n\r\n    return (\r\n      <QueueDiv>\r\n        <YourTurnModal />\r\n\r\n        <Button.Group\r\n          size=\"huge\"\r\n          style={{ marginBottom: 12, width: '95%' }}\r\n          fluid\r\n          vertical\r\n        >\r\n          <Button\r\n            compact\r\n            content=\"Queue\"\r\n            icon={this.state.iconToDisplay}\r\n            labelPosition=\"right\"\r\n            onClick={this.alterStudentDisplay.bind(this)}\r\n            style={{\r\n              fontSize: '1.5vw',\r\n              textAlign: 'center',\r\n              width: '100%',\r\n              marginBottom: '2%',\r\n              minWidth: '41px',\r\n            }}\r\n          />\r\n        </Button.Group>\r\n\r\n        <QueueDiv\r\n          style={{ width: '100%', marginBottom: '2%', minWidth: '41px' }}\r\n        >\r\n          {queueLabels}\r\n        </QueueDiv>\r\n        {this.getButtonToDisplay()}\r\n\r\n        <NotificationContainer />\r\n      </QueueDiv>\r\n    )\r\n  }\r\n}\r\n\r\nStudentQueueView.propTypes = {\r\n  onJoin: PropTypes.func.isRequired,\r\n}\r\n\r\nexport default StudentQueueView\r\n"]},"metadata":{},"sourceType":"module"}